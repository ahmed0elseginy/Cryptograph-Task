<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Encryption System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" th:href="@{/style.css}">
</head>
<body>

<div class="main-container">
    <!-- Header Section -->
    <div class="header">
        <img src="image/img.png" alt="Encryption Logo" class="logo-inside">
        <h1 class="title">Advanced Encryption System</h1>
        <p class="subtitle">A comprehensive tool for data encryption using modern security algorithms with LCG key generation</p>
    </div>

    <!-- Algorithm Tabs -->
    <div class="algorithm-tabs">
        <button class="tab-btn active" onclick="openTab('cbc-tab')">
            <i class="fas fa-link"></i> CBC
        </button>
        <button class="tab-btn" onclick="openTab('rsa-tab')">
            <i class="fas fa-key"></i> RSA
        </button>
        <button class="tab-btn" onclick="openTab('sha1-tab')">
            <i class="fas fa-fingerprint"></i> SHA-1
        </button>
    </div>

    <!-- CBC Algorithm Tab -->
    <div id="cbc-tab" class="tab-content active">
        <div class="algorithm-card">
            <div class="algorithm-header">
                <i class="fas fa-link algorithm-icon"></i>
                <div>
                    <h3 class="algorithm-title">CBC (Cipher Block Chaining)</h3>
                    <p class="algorithm-desc">
                        A block cipher mode that provides confidentiality by XORing each plaintext block with the previous ciphertext block before encryption.
                        Uses an Initialization Vector (IV) for the first block. The LCG generator provides the encryption key for enhanced security.
                    </p>
                </div>
            </div>

            <div class="input-section">
                <label for="cbc-inputText">Text to encrypt:</label>
                <input type="text" id="cbc-inputText" placeholder="Enter the text you want to encrypt with CBC..." required>
            </div>

            <div class="key-box">
                <span class="key-label">Encryption Key (Generated by LCG):</span>
                <span id="cbc-key">No key generated yet</span><br>

<!--                <span class="key-label">Initialization Vector (IV):</span>-->
<!--                <span id="cbc-iv">No IV generated yet</span>-->
            </div>

            <button onclick="encryptCBC()">
                <i class="fas fa-lock"></i> Encrypt with CBC
            </button>

            <div class="output-box" id="cbc-output">Encryption result will appear here</div>
        </div>
    </div>

    <!-- RSA Algorithm Tab -->
    <div id="rsa-tab" class="tab-content">
        <div class="algorithm-card">
            <div class="algorithm-header">
                <i class="fas fa-key algorithm-icon"></i>
                <div>
                    <h3 class="algorithm-title">RSA (Asymmetric Encryption)</h3>
                    <p class="algorithm-desc">
                        A public-key cryptosystem that uses two mathematically linked keys for secure data transmission.
                        The LCG generator helps create the initial prime numbers used in key generation. RSA provides both encryption and digital signature capabilities.
                    </p>
                </div>
            </div>

            <div class="input-section">
                <label for="rsa-inputText">Text to encrypt:</label>
                <input type="text" id="rsa-inputText" placeholder="Enter the text you want to encrypt with RSA..." required>
            </div>

            <div class="key-box">
                <div class="key-pair">
                    <span class="key-label">Public Key:</span>
                    <span id="rsa-public-key" class="key-value">Not available yet</span>
                </div>
                <div class="key-pair">
                    <span class="key-label">Private Key:</span>
                    <span id="rsa-private-key" class="key-value">Hidden for security reasons</span>
                </div>
            </div>

            <button onclick="encryptRSA()">
                <i class="fas fa-user-lock"></i> Encrypt with RSA
            </button>

            <div class="output-box" id="rsa-output">Encryption result will appear here</div>
        </div>
    </div>

    <!-- SHA-1 Algorithm Tab -->
    <div id="sha1-tab" class="tab-content">
        <div class="algorithm-card">
            <div class="algorithm-header">
                <i class="fas fa-fingerprint algorithm-icon"></i>
                <div>
                    <h3 class="algorithm-title">SHA-1 (Secure Hash Algorithm)</h3>
                    <p class="algorithm-desc">
                        A cryptographic hash function that produces a 160-bit (20-byte) hash value known as a message digest.
                        While no longer considered secure against well-funded attackers, it's still useful for checksums and data integrity verification.
                        The LCG generator may be used to create salt values when needed.
                    </p>
                </div>
            </div>

            <div class="input-section">
                <label for="sha1-inputText">Text to hash:</label>
                <input type="text" id="sha1-inputText" placeholder="Enter the text you want to hash with SHA-1..." required>
            </div>

            <button onclick="hashSHA1()">
                <i class="fas fa-hashtag"></i> Generate SHA-1 Hash
            </button>

            <div class="output-box" id="sha1-output">Hash result will appear here</div>
        </div>
    </div>
</div>

<script>
    // Tab functionality
    function openTab(tabId) {
        // Hide all tab contents
        const tabContents = document.getElementsByClassName('tab-content');
        for (let i = 0; i < tabContents.length; i++) {
            tabContents[i].classList.remove('active');
        }

        // Remove active class from all tab buttons
        const tabButtons = document.getElementsByClassName('tab-btn');
        for (let i = 0; i < tabButtons.length; i++) {
            tabButtons[i].classList.remove('active');
        }

        // Show the selected tab content and mark button as active
        document.getElementById(tabId).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    // Animation on load
    document.addEventListener('DOMContentLoaded', function () {
        const cards = document.querySelectorAll('.algorithm-card');
        cards.forEach((card, index) => {
            setTimeout(() => {
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, 100 * index);
        });
    });

    // AJAX functions
    function encryptCBC() {
        const inputText = document.getElementById('cbc-inputText').value;

        fetch('/encrypt/cbc', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ inputText })
        })
            .then(response => response.json())
            .then(data => {
                document.getElementById('cbc-key').textContent = data.cbcKey;
                document.getElementById('cbc-output').textContent = data.cbcEncryptedText;
            })
            .catch(error => console.error('Error:', error));
    }

    function encryptRSA() {
        const inputText = document.getElementById('rsa-inputText').value;

        fetch('/encrypt/rsa', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ inputText })
        })
            .then(response => response.json())
            .then(data => {
                document.getElementById('rsa-public-key').textContent = data.rsaPublicKey;
                document.getElementById('rsa-private-key').textContent = data.rsaPrivateKey;
                document.getElementById('rsa-output').textContent = data.rsaEncryptedText;
            })
            .catch(error => console.error('Error:', error));
    }

    function hashSHA1() {
        const inputText = document.getElementById('sha1-inputText').value;

        fetch('/encrypt/sha1', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ inputText })
        })
            .then(response => response.json())
            .then(data => {
                document.getElementById('sha1-output').textContent = data.sha1HashedText;
            })
            .catch(error => console.error('Error:', error));
    }
</script>
</body>
</html>